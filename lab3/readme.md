# Лабораторная работа №3
Реализация свёрточной нейронной сети для задачи классификации.

Сравнение конфигураций свёрточных нейронных сетей.

# Описание директорий

## log
Здесь лежат файлы .json со статистикой по разным конфигурациям.
Они содержат параметры сети (число слоёв, число нейронов, параметр обучения, размер пачки, число эпох) и статистику 
обучения (время, функцию потерь на тестовом и тренировочном наборе, точность на тестовом и тренировочном наборе)

## models
Здесь лежат файлы .h5 с конфигурацией сетей Keras для их последующей повторной загрузки.

## src
Скрипты для работы с данными и фреймворком.
### datahandler.py
Содержит методы для чтения, обработки, визуализации данных.
### modelhandler.py
Содержит методы для работы с сетью: запуск обучения, сбор статистики, сохранение и загрузка сетей.
### reporthandler.py
Содержит методы для генерации таблиц для отчёта.
### notebook.py
Является точкой входа. Блокнот для проведения экспериментов. Содержит метод для запуска серийного эксперимента с 
возможностью вариации количества скрытых слоёв и числа нейронов на них.

## Структура сетей

[comment]: # (graph_model_table_start)

|                                                                                                  Model name                                                                                                  |                                                                                                              Model graph                                                                                                              |
| :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_flatten_dense_300_model                                                                                                                                                  | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_flatten_dense_300_model.png)                                                                                                                                                  |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_128_model                                                                                                                                                  | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_128_model.png)                                                                                                                                                  |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_model                                                                                                                                                  | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_model.png)                                                                                                                                                  |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_500_model                                                                                                                                                  | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_500_model.png)                                                                                                                                                  |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_model                                                                                                                                      | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_model.png)                                                                                                                                      |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_128_model                                                                                                                                      | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_128_model.png)                                                                                                                                      |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_model                                                                                                                                      | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_model.png)                                                                                                                                      |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_500_model                                                                                                                                      | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_500_model.png)                                                                                                                                      |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_model                                                                                                                  | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_model.png)                                                                                                                  |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_model                                                                                                                  | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_model.png)                                                                                                                  |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_model                                                                                          | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_model.png)                                                                                          |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_model                                                                                          | ![](img/graph_model/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_model.png)                                                                                          |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_model                                                                                  | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_model.png)                                                                                  |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_conv2d_128_3x3_max_pooling2d_2x2_flatten_dense_300_model                                                 | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_conv2d_128_3x3_max_pooling2d_2x2_flatten_dense_300_model.png)                                                 |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_128_3x3_max_pooling2d_2x2_dropout_0.4_flatten_dense_300_model | ![](img/graph_model/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_128_3x3_max_pooling2d_2x2_dropout_0.4_flatten_dense_300_model.png) |

[comment]: # (graph_model_table_end)

## Численные эксперименты
### Параметры

### Результаты
[comment]: # (result_table_start)

|                                                                                               Model name                                                                                               | Test accuracy | Test loss | Train accuracy | Train loss | Time_train (s) |
| :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-----------: | :-------: | :------------: | :--------: | :------------: |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_flatten_dense_300                                                                                                                                                  |    0.8489     |  0.9367   |     0.9773     |   0.0868   |    251.6053    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_128                                                                                                                                                  |    0.8705     |  0.7976   |     0.9814     |   0.0719   |    293.2608    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300                                                                                                                                                  |    0.8714     |  0.7749   |     0.9761     |   0.0944   |    433.9981    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_500                                                                                                                                                  |    0.8647     |  0.9279   |     0.9775     |    0.09    |    582.9919    |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300                                                                                                                                      |    0.8644     |  0.7428   |     0.9787     |   0.0937   |    268.1841    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_128                                                                                                                                      |    0.8671     |  0.8147   |     0.9796     |   0.0859   |    328.8819    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300                                                                                                                                      |     0.869     |  0.8587   |     0.9825     |   0.0746   |    468.0969    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_500                                                                                                                                      |     0.864     |  0.8862   |     0.9788     |   0.0942   |    621.7271    |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300                                                                                                                  |    0.9023     |  0.4662   |     0.989      |   0.0389   |    324.8156    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300                                                                                                                  |    0.9171     |  0.4545   |     0.9936     |   0.0231   |    552.5494    |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300                                                                                          |    0.8955     |  0.3599   |     0.9808     |   0.0845   |    351.4733    |
| CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300                                                                                          |    0.9223     |  0.2945   |     0.9949     |   0.0282   |    601.2562    |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300                                                                                  |    0.8933     |  0.5679   |     0.9905     |   0.0315   |    361.1749    |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_conv2d_128_3x3_max_pooling2d_2x2_flatten_dense_300                                                 |    0.8694     |  0.6924   |     0.9899     |   0.0329   |    386.0955    |
| CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_128_3x3_max_pooling2d_2x2_dropout_0.4_flatten_dense_300 |    0.7755     |  0.6814   |     0.9232     |   0.2876   |    413.517     |

[comment]: # (result_table_end)

[comment]: # (graph_table_start)

|                                                                                                                     Accuracy                                                                                                                     |                                                                                                                     Loss                                                                                                                     |
| :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_flatten_dense_300_accuracy.png)                                                                                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_flatten_dense_300_loss.png)                                                                                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_128_accuracy.png)                                                                                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_128_loss.png)                                                                                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_accuracy.png)                                                                                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_loss.png)                                                                                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_500_accuracy.png)                                                                                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_500_loss.png)                                                                                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_accuracy.png)                                                                                                                                      | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_loss.png)                                                                                                                                      |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_128_accuracy.png)                                                                                                                                      | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_128_loss.png)                                                                                                                                      |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_accuracy.png)                                                                                                                                      | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_300_loss.png)                                                                                                                                      |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_500_accuracy.png)                                                                                                                                      | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_flatten_dense_500_loss.png)                                                                                                                                      |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_accuracy.png)                                                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_flatten_dense_300_loss.png)                                                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_accuracy.png)                                                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_loss.png)                                                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_accuracy.png)                                                                                          | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_loss.png)                                                                                          |
| ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_accuracy.png)                                                                                          | ![](img/graph_loss_accuracy/CNN_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.5_flatten_dense_300_loss.png)                                                                                          |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_accuracy.png)                                                                                  | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_flatten_dense_300_loss.png)                                                                                  |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_conv2d_128_3x3_max_pooling2d_2x2_flatten_dense_300_accuracy.png)                                                 | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_conv2d_32_3x3_max_pooling2d_2x2_conv2d_64_3x3_max_pooling2d_2x2_conv2d_128_3x3_max_pooling2d_2x2_flatten_dense_300_loss.png)                                                 |
| ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_128_3x3_max_pooling2d_2x2_dropout_0.4_flatten_dense_300_accuracy.png) | ![](img/graph_loss_accuracy/CNN_conv2d_16_3x3_max_pooling2d_2x2_dropout_0.2_conv2d_32_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_64_3x3_max_pooling2d_2x2_dropout_0.4_conv2d_128_3x3_max_pooling2d_2x2_dropout_0.4_flatten_dense_300_loss.png) |

[comment]: # (graph_table_end)

### Анализ

